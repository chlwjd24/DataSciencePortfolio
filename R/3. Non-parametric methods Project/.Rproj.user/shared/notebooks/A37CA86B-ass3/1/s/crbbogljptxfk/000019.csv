"0","library(ggplot2)"
"0",""
"0","# True density function"
"0","x <- seq(0, 5, length.out = 1000)"
"0","true_density <- alpha * dchisq(x, df = 3) + (1-alpha) * dbeta(x, shape1 = 5, shape2 = 2)"
"0",""
"0","# Histogram"
"0","hist_plot <- ggplot() + geom_histogram(aes(x = sample, y = ..density..), bins = 20, fill = ""lightblue"", color = ""black"") +"
"0","  geom_density(data = as.data.frame(sample), aes(x = sample), color = ""red"", linetype = ""dashed"") +"
"0","  ggtitle(""Histogram"")"
"0",""
"0","# Kernel density estimate"
"0","kde_plot <- ggplot() + geom_density(data = as.data.frame(sample), aes(x = sample), color = ""blue"") +"
"0","  geom_line(data = as.data.frame(x), aes(x = x, y = true_density), color = ""red"", linetype = ""dashed"") +"
"0","  ggtitle(""Kernel Density Estimate"")"
"0",""
"0","# Combine plots"
"0","library(cowplot)"
"0","plot_grid(hist_plot, kde_plot, nrow = 1)"
