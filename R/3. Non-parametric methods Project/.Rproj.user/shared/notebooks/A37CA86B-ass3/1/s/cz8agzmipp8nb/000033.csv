"0","n <- 500  # sample size"
"0","a <- 0"
"0","b <- 5"
"0",""
"0","# True density function"
"0","true_density <- function(x) alpha * dchisq(x, df = 3) + (1 - alpha) * dbeta(x, shape1 = 5, shape2 = 2)"
"0",""
"0","# Kernel estimator"
"0","fhat <- function(x, h, X) {"
"0","  n <- length(X)"
"0","  sum(g_alpha((X - x) / h)) / (n * h)"
"0","}"
"0","fhat <- Vectorize(fhat, ""x"")"
"0",""
"0","# Bandwidth estimation"
"0","h1 <- bw.nrd(x = sample)"
"0",""
"0","# Estimation of MISE"
"0","repl <- 1000"
"0","ISE <- rep(NA, repl)"
"0","for (i in 1:repl) {"
"0","  X <- sample"
"0","  ISE[i] <- try({"
"0","    x_vals <- seq(a, b, length.out = 1000)"
"0","    true_density_vals <- true_density(x_vals)"
"0","    fhat_vals <- fhat(x_vals, h = h1, X = sample)"
"0","    mse_vals <- (true_density_vals - fhat_vals)^2"
"0","    integrate(function(x) interp1d(x_vals, mse_vals)(x), a, b)$value"
"0","  }, silent = TRUE)"
"0","}"
"0","MISE <- mean(ISE, na.rm = TRUE)"
"2","Warning: argument is not numeric or logical: returning NA"
"0","message(""Estimation of MISE is "", MISE, ""."")"
"2","Estimation of MISE is NA.
"
